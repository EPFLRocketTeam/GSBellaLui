#!/usr/bin/env python
# coding: utf-8

import serial
import time

serial_port = serial.Serial()
serial_port.baudrate = 115200
serial_port.port = 'COM14'
serial_port.open()

#ert_launch = bytes.fromhex('555555550002cd0104ff002a069abf864000bbc00000bcc0000040a0000000000000411fea434224e14844575ae1000000002dd4197e0074900013a200415cbffcfffe42555555550002cd0204ff002a06a9bf7f0000bcc00000bcf0000040a0000000000000411fea434224e148445758520000000010ec555555550002cd0304ff002a06b8bf828000bd400000bcf0000040a0000000000000411fea434224cccd44575ae100000000aca5717e0040900013a200415cbffcfffe42555555550002cd0404ff002a06c7bf7c0000bd280000bbc0000040a0000000000000411fea434224cccd445758520000000025f49d7e0074900013a200415cbffcfffe42555555550002cd0504ff002a06d6bf760000bd100000bd84000040a0000000000000411fea434224cccd44575d71000000009629555555550002cd0604ff002a06e5bf80400000000000bcc0000040a0000000000000411fea434224d70a44575852000000003521907e0061900013a200415cbffcfffe42555555550800b81603ff002a06ef0c3f2b851f4203c617c2d5d3d700021f3435ed555555550002cd0704ff002a06f4bf84c000bd4000003c40000040a0000000000000411fea434224d70a44575d710000000058ddc57e0074900013a200415cbffcfffe42555555550002cd0804ff002a0703bf828000bd840000bc40000040a0000000000000411fea434224e1484457599a00000000990d555555550002cd0904ff002a0712bf828000bd700000bbc0000040a0000000000000411fea434224d70a44575b8500000000af75657e0040900013a200415cbffcfffe42555555550002cd0a04ff002a0721bf81c000bd100000bcc0000040a0000000000000411fea434224d70a44575e1400000000c1c2147e0040900013a200415cbffcfffe42555555550002cd0d04ff002a074ebf804000bd280000bcc0000040a0000000000000411fea434224d70a44575e1400000000e525c67e0061900013a200415cbffcfffe42555555550002cd0e04ff002a075dbf804000bd7000000000000040a0000000000000414194d84224e14844575eb800000000d8a8555555550800b81703ff002a075d0c3f28f5c34203c617c2d5d3d700021f2a756eb07e0074900013a200415cbffcfffe42555555550002cd0f04ff002a076cbf7a8000bd580000bcf0000040a0000000000000411fea434224d70a44575c29000000008667555555550002cd1004ff002a077bbf810000bd400000bc90000040a0000000000000411fea434224d70a4457599a00000000b7d1e17e0074900013a200415cbffcfffe42555555550002cd1104ff002a078abf828000bbc00000bd90000040a0000000000000414194d84224d70a4457599a000000006e27555555550002cd1204ff002a0799bf828000bd840000bcf0000040a0000000000000411fea434224b852445758f6000000000405f17e0040900013a200415cbffcfffe42555555550002cd1304ff002a07a8bf828000bd8400003cc0000040a0000000000000411fea434224b852445758f600000000685b8a7e0074900013a200415cbffcfffe42555555550002cd1404ff002a07b7bf7f0000bd5800000000000040a0000000000000411fea434224c28f445755c300000000f95b555555550002cd1504ff002a07c6bf828000bd100000bc90000040a0000000000000411fea434224c28f445757ae000000006d8bbb7e0061900013a200415cbffcfffe42555555550800b81803ff002a07cb0c3f28f5c34203c617c2d5d3d700021f2a48d7555555550002cd1604ff002a07d5bf828000bd100000bc40000040a0000000000000411fea434224c28f44575c29000000003ebcf77e0074900013a200415cbffcfffe42555555550002cd1704ff002a07e4bf828000bc900000bc40000040a0000000000000411fea434224cccd44575ae100000000fa6a555555550002cd1804ff002a07f3bf81c000bd840000bcc0000040a0000000000000411fea434224cccd44575a3d00000000fc78f17e0040900013a200415cbffcfffe42555555550002cd1904ff002a0802bf84c000bd7000000000000040a0000000000000411fea434224cccd44575ae1000000005dbd247e0074900013a200415cbffcfffe42555555550002cd1a04ff002a0811bf7f0000bd100000bd10000040a0000000000000414194d84224c28f44575c29000000002cd3555555550002cd1b04ff002a0820bf778000bd580000bcf0000040a0000000000000411fea434224c28f4457570a00000000f33ccb7e0040900013a200415cbffcfffe42555555550002cd1c04ff002a082fbf81000000000000bcc0000040a0000000000000411fea434224cccd44575d71000000004aadf87e0061900013a200415cbffcfffe42555555550800b81903ff002a08390c3f35c28f4203c617c2d5d3d700021f2a5681555555550002cd1d04ff002a083ebf81c000bda800000000000040a0000000000000411fea434224cccd44575ae100000000c93ad67e0074900013a200415cbffcfffe42555555550002cd1e04ff002a084dbf840000bd1000003cc0000040a0000000000000411fea434224cccd44575b850000000043ac555555550002cd1f04ff002a085cbf828000bd4000003cc0000040a0000000000000411fea434224cccd44575a3d00000000be6c297e0074900013a200415cbffcfffe42555555550002cd2004ff002a086bbf7f0000bd100000bdcc000040a0000000000000411fea434224cccd4457599a00000000607d555555550002cd2104ff002a087abf858000bd840000bd28000040a000000000000040dad4c84224cccd4457599a00000000aecc5b7e0040900013a200415cbffcfffe42555555550002cd2204ff002a0889bf7a8000bcf00000bcf0000040a000000000000040dad4c84224cccd44575c2900000000b250587e0074900013a200415cbffcfffe42555555550002cd2304ff002a0898bf810000bdb400003c40000040a000000000000040dad4c84224c28f44575b85000000008e8d555555550002cd2404ff002a08a7bf7f0000bc900000bd10000040a000000000000040dad4c84224cccd44575ae10000000024f9fe7e0061900013a200415cbffcfffe42555555550800b81a03ff002a08a70c3f2e147b4203c617c2d5d3d700021f20fb71555555550002cd2504ff002a08b6bf7c0000bd4000003c40000040a000000000000040dad4c84224cccd44575ae100000000a14ec17e0074900013a200415cbffcfffe42555555550002cd2604ff002a08c5bf7f0000bd580000bbc0000040a000000000000040dad4c84224cccd445758f6000000000fc5555555550002cd2704ff002a08d4bf810000bd580000bcc0000040a0000000000000411fea434224cccd44575666000000000900d07e0040900013a200415cbffcfffe42555555550002cd2804ff002a08e3bf790000bd100000bcf0000040a0000000000000411fea434224d70a44575d71000000007c0b6b7e0074900013a200415cbffcfffe42555555550002cd2904ff002a08f2bf7d8000bd840000bbc0000040a0000000000000411fea434224c28f4457600000000000f452555555550002cd2a04ff002a0901bf84c000bc9000003c40000040a0000000000000411fea434224cccd4457599a00000000468bb97e0061900013a200415cbffcfffe42555555550002cd2b04ff002a0910bf81c000bcf00000bc90000040a0000000000000411fea434224cccd44575ae1000000007782555555550800b81b03ff002a09150c3f2b851f4203c617c2d5d3d700021f2010d83d7e0074900013a200415cbffcfffe42555555550002cd2c04ff002a091fbf858000bd580000bcc0000040a0000000000000411fea434224cccd44575e1400000000a8a7555555550002cd2d04ff002a092ebf81c000bd700000bcf0000040a0')
#single_packet = bytes.fromhex('555555550002cd0104ff002a069abf864000bbc00000bcc0000040a0000000000000411fea434224e14844575ae1000000002dd4197e0074900013a200415cbffcfffe42')

fname = 'bytes_received_900Mhz_009_1529594910849'
with open(fname) as f:
    content = f.readlines()
content = [x.strip() for x in content] 
    
last_ts = 0;

for l in content:
    timestamp, data = l.split('\t\t')
    timestamp = int(timestamp)
    data = bytes.fromhex(data.replace(" ", ""))
    
    serial_port.write(data)
    
    diff = (timestamp-last_ts)/1000000
    time.sleep(min(diff, 0.01))
    last_ts = timestamp

serial_port.close()